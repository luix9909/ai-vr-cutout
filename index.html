<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI AR Gallery Pro - Black & Purple</title>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-event-set-component@^5.0.0/dist/aframe-event-set-component.min.js"></script>
    <style>
        body { margin: 0; direction: rtl; background: #050014; font-family: Arial; color: #d8b4fe; overflow-x: hidden; }
        #ui {
            position: fixed; bottom: 0; left: 0; width: 100%;
            background: rgba(20,10,40,0.96); color: #c084fc;
            padding: 15px 20px; border-top: 3px solid #7e22ce;
            box-shadow: 0 -5px 30px rgba(126,34,206,0.5);
            pointer-events: auto; overflow-x: auto; white-space: nowrap;
            text-align: center; z-index: 9999;
            box-sizing: border-box;
        }
        .thumb {
            width: 110px; height: 150px; margin: 8px;
            object-fit: cover; border: 3px solid #7e22ce;
            border-radius: 12px; cursor: pointer; display: inline-block;
            background: #12021a; box-shadow: 0 0 18px rgba(126,34,206,0.6);
            transition: transform 0.3s;
        }
        .thumb:hover {
            transform: scale(1.05);
            border-color: #c084fc;
        }
        button {
            padding: 10px 20px; margin: 6px; font-size: 16px;
            background: #7e22ce; color: white; border: none;
            border-radius: 8px; cursor: pointer; font-weight: bold;
            box-shadow: 0 0 12px rgba(126,34,206,0.7);
            transition: all 0.3s;
        }
        button:hover {
            background: #9333ea;
            transform: translateY(-2px);
            box-shadow: 0 0 20px rgba(126,34,206,0.9);
        }
        button.delete { background: #c026d3; }
        button.delete:hover { background: #d946ef; }
        button.rotate { background: #a855f7; }
        button.reset { background: #6b21a8; }
        #status { 
            font-size: 18px; margin: 10px; color: #c084fc; 
            text-shadow: 0 0 10px #7e22ce; padding: 10px;
            background: rgba(126,34,206,0.1); border-radius: 8px;
            min-height: 24px;
        }
        #fileInput {
            padding: 10px;
            margin: 10px;
            background: #1e1b4b;
            color: white;
            border: 2px solid #7e22ce;
            border-radius: 8px;
            cursor: pointer;
        }
        #fileInput:hover {
            background: #312e81;
        }
        h3 {
            margin: 0 0 15px 0;
            color: #d8b4fe;
            text-shadow: 0 0 15px #c084fc;
        }
        .hud-thumb {
            width: 60px; height: 80px; margin: 5px;
            object-fit: cover; border: 2px solid #7e22ce;
            border-radius: 8px; cursor: pointer; 
            background: #12021a; 
            display: inline-block;
        }
        #loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #c084fc;
            font-size: 24px;
            z-index: 10000;
            background: rgba(0,0,0,0.8);
            padding: 20px;
            border-radius: 10px;
            display: none;
        }
    </style>
</head>
<body>
    <div id="loading">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
    
    <div id="ui">
        <h3>ğŸ–¼ï¸ Ù…Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ± ÙˆØ§Ù„ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª (Black & Purple) ğŸ¬</h3>
        <input type="file" id="fileInput" accept="image/*,video/*" multiple>
        <div id="thumbnails"></div>
        <div id="status">â³ Ø§Ø±ÙØ¹ Ù…Ù„ÙØ§ØªÙƒ Ø«Ù… Ø§Ø¶ØºØ· Ø¹Ù„ÙŠÙ‡Ø§ Ù„Ø¥Ø¶Ø§ÙØªÙ‡Ø§ ÙÙŠ Ø§Ù„ØºØ±ÙØ©</div>
        <button onclick="enterAR()">ğŸš€ Ø¯Ø®ÙˆÙ„ AR</button>
        <button onclick="clearAll()" class="delete">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„</button>
        <button onclick="resetPositions()" class="reset">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ±ØªÙŠØ¨</button>
    </div>

    <a-scene embedded 
             renderer="antialias: true; alpha: true; logarithmicDepthBuffer: true"
             background="transparent: true"
             loading-screen="enabled: false">

        <a-assets id="assets" timeout="10000">
            <!-- Assets will be added dynamically -->
        </a-assets>

        <!-- Lighting -->
        <a-light type="ambient" intensity="0.8" color="#d8b4fe"></a-light>
        <a-light type="directional" 
                 position="-4 6 -4" 
                 intensity="1.2" 
                 color="#c084fc"
                 cast-shadow="true"></a-light>
        <a-light type="hemisphere" 
                 sky-color="#1e1b4b" 
                 ground-color="#050014" 
                 intensity="0.6"></a-light>

        <!-- Floor -->
        <a-plane position="0 0 0" 
                 rotation="-90 0 0" 
                 width="20" 
                 height="20"
                 material="color: #0f0a23; metalness: 0.2; roughness: 0.8"
                 shadow="receive: true"></a-plane>

        <!-- Controllers with Laser -->
        <a-entity id="leftHand" 
                  hand-controls="hand: left"
                  laser-controls="hand: left"
                  raycaster="objects: .clickable, .interactive; far: 10; showLine: true; lineColor: #c084fc; lineOpacity: 0.8;"></a-entity>
        <a-entity id="rightHand" 
                  hand-controls="hand: right"
                  laser-controls="hand: right"
                  raycaster="objects: .clickable, .interactive; far: 10; showLine: true; lineColor: #c084fc; lineOpacity: 0.8;"></a-entity>

        <!-- Camera -->
        <a-entity id="cameraRig" position="0 1.6 0">
            <a-camera id="camera" 
                      position="0 0 0"
                      wasd-controls="enabled: false"
                      look-controls="enabled: true">
                
                <!-- HUD in VR -->
                <a-entity id="hud" position="0 -0.4 -0.8" scale="0.9 0.9 0.9">
                    <a-plane position="0 0 0" 
                             width="4.5" 
                             height="1.4" 
                             material="color: #0f001f; opacity: 0.9; transparent: true; side: double">
                    </a-plane>
                    
                    <a-entity id="hud-thumbnails" 
                              position="0 0.2 0.01"
                              layout="type: line; margin: 0.1">
                    </a-entity>
                    
                    <a-text value="ğŸ¨ Ø§Ù„Ù…Ø¹ Gallery - Ø§Ø¶ØºØ· Ø¨Ø§Ù„Ù„ÙŠØ²Ø± Ù„Ù„Ø¥Ø¶Ø§ÙØ© ğŸ¯" 
                            position="0 -0.5 0.01" 
                            color="#c084fc" 
                            align="center" 
                            width="4"
                            font="https://cdn.aframe.io/fonts/MoSans-Regular-AR.json"
                            shadow="color: #7e22ce; offset: 0.02 0.02 0.02">
                    </a-text>
                </a-entity>
            </a-camera>
        </a-entity>

        <!-- Navigation Instructions -->
        <a-entity position="0 2.5 -3" 
                  geometry="primitive: plane; width: 3; height: 1.5"
                  material="color: #1e1b4b; opacity: 0.8; transparent: true; side: double"
                  text="value: ğŸ® Ø§Ù„ØªØ­ÙƒÙ…:\nØ­Ø±Ùƒ Ø¨Ø§Ù„Ù…Ø³Ùƒ\nÙƒØ¨Ø±/ØµØºØ± Ø¨Ø§Ù„Ø«ÙˆÙ…Ø¨Ø³ØªÙƒ\nØ§Ø­Ø°Ù Ø¨Ø§Ù„Ø²Ø± X; 
                        align: center; 
                        color: #d8b4fe; 
                        width: 3;
                        font: https://cdn.aframe.io/fonts/MoSans-Regular-AR.json"
                  always-face-camera></a-entity>

    </a-scene>

    <script>
        const scene = document.querySelector('a-scene');
        const assets = document.getElementById('assets');
        const thumbnailsDiv = document.getElementById('thumbnails');
        const hudThumbnails = document.getElementById('hud-thumbnails');
        const status = document.getElementById('status');
        const loading = document.getElementById('loading');
        
        let placementCount = 0;
        let selectedEntity = null;
        let mediaEntities = [];

        // Register Always Face Camera Component
        AFRAME.registerComponent('always-face-camera', {
            tick: function () {
                const camera = document.querySelector('[camera]');
                if (camera) {
                    const cameraPos = camera.object3D.getWorldPosition(new THREE.Vector3());
                    this.el.object3D.lookAt(cameraPos);
                }
            }
        });

        // Enhanced Media Controls Component
        AFRAME.registerComponent('media-controls', {
            init: function () {
                this.isSelected = false;
                this.isGrabbed = false;
                this.isResizing = false;
                this.isRotating = false;
                
                const el = this.el;
                
                // Add selection highlight
                el.setAttribute('material', 'shader: flat; transparent: true; opacity: 1');
                
                // Make it interactive
                el.classList.add('interactive');
                
                // Add border for selected state
                this.border = document.createElement('a-entity');
                this.border.setAttribute('geometry', 'primitive: box; width: 1.05; height: 1.05; depth: 0.01');
                this.border.setAttribute('material', 'color: #c084fc; transparent: true; opacity: 0; side: front');
                this.border.setAttribute('position', '0 0 0.01');
                el.appendChild(this.border);
                
                // Add control instructions
                this.instructions = document.createElement('a-entity');
                this.instructions.setAttribute('position', '0 1.2 0');
                this.instructions.setAttribute('text', {
                    value: 'ğŸ® Ø§Ù„Ù…Ø³Ùƒ: ØªØ±ÙŠÙ‚Ø±\nğŸ”„ ØªØ¯ÙˆÙŠØ±: X + Ø­Ø±ÙƒØ©\nğŸ“ ØªÙƒØ¨ÙŠØ±: Y + Ø«ÙˆÙ…Ø¨Ø³ØªÙƒ\nâŒ Ø­Ø°Ù: B',
                    align: 'center',
                    color: '#d8b4fe',
                    width: 2,
                    font: 'https://cdn.aframe.io/fonts/MoSans-Regular-AR.json'
                });
                this.instructions.setAttribute('visible', 'false');
                el.appendChild(this.instructions);
                
                // Event listeners
                el.addEventListener('click', (evt) => {
                    if (selectedEntity && selectedEntity !== el) {
                        selectedEntity.components['media-controls'].deselect();
                    }
                    this.select();
                });
                
                el.addEventListener('grab-start', (evt) => {
                    this.grab(evt.detail.hand);
                });
                
                el.addEventListener('grab-end', (evt) => {
                    this.release();
                });
                
                // Controller events
                scene.addEventListener('buttondown', (evt) => {
                    if (this.isSelected) {
                        const button = evt.detail.id;
                        const hand = evt.detail.hand;
                        
                        switch(button) {
                            case 'xbutton':
                                this.isRotating = true;
                                status.textContent = 'ğŸ”„ ÙˆØ¶Ø¹ Ø§Ù„ØªØ¯ÙˆÙŠØ± Ù…ÙØ¹Ù„';
                                break;
                            case 'ybutton':
                                this.isResizing = true;
                                status.textContent = 'ğŸ“ ÙˆØ¶Ø¹ Ø§Ù„ØªÙƒØ¨ÙŠØ±/Ø§Ù„ØªØµØºÙŠØ± Ù…ÙØ¹Ù„';
                                break;
                            case 'bbutton':
                                this.delete();
                                break;
                        }
                    }
                });
                
                scene.addEventListener('buttonup', (evt) => {
                    const button = evt.detail.id;
                    if (button === 'xbutton') this.isRotating = false;
                    if (button === 'ybutton') this.isResizing = false;
                });
                
                scene.addEventListener('thumbstickmoved', (evt) => {
                    if (this.isSelected && !this.isGrabbed) {
                        const axis = evt.detail.axis;
                        
                        if (this.isResizing) {
                            // Scale with thumbstick vertical movement
                            const currentScale = el.object3D.scale.x;
                            const newScale = Math.max(0.5, Math.min(3, currentScale + axis.y * 0.1));
                            el.object3D.scale.set(newScale, newScale, newScale);
                            status.textContent = `ğŸ“ Ø§Ù„Ø­Ø¬Ù…: ${newScale.toFixed(2)}x`;
                        }
                        else if (this.isRotating) {
                            // Rotate with thumbstick horizontal movement
                            const currentRotation = el.object3D.rotation.y;
                            el.object3D.rotation.y = currentRotation + axis.x * 0.1;
                        }
                    }
                });
            },
            
            select: function() {
                this.isSelected = true;
                selectedEntity = this.el;
                this.border.setAttribute('material', 'opacity', 0.5);
                this.instructions.setAttribute('visible', 'true');
                status.textContent = 'âœ… Ø§Ù„Ø¹Ù†ØµØ± Ù…Ø®ØªØ§Ø± - Ø§Ø³ØªØ®Ø¯Ù… Ø£Ø²Ø±Ø§Ø± Ø§Ù„ÙŠØ¯ Ù„Ù„ØªØ­ÙƒÙ…';
            },
            
            deselect: function() {
                this.isSelected = false;
                this.border.setAttribute('material', 'opacity', 0);
                this.instructions.setAttribute('visible', 'false');
            },
            
            grab: function(hand) {
                this.isGrabbed = true;
                this.el.setAttribute('animation', {
                    property: 'position',
                    to: hand.object3D.position.x + ' ' + 
                        (hand.object3D.position.y - 0.2) + ' ' + 
                        hand.object3D.position.z,
                    dur: 100,
                    easing: 'easeOutQuad'
                });
                status.textContent = 'ğŸ–ï¸ Ø§Ù„Ø¹Ù†ØµØ± Ù…Ù…Ø³ÙˆÙƒ - Ø­Ø±Ø±Ù‡ Ù„Ù„Ø¥ÙÙ„Ø§Øª';
            },
            
            release: function() {
                this.isGrabbed = false;
                status.textContent = 'âœ… Ø§Ù„Ø¹Ù†ØµØ± ØªÙ… ØªØ­Ø±ÙŠØ±Ù‡';
            },
            
            delete: function() {
                const index = mediaEntities.indexOf(this.el);
                if (index > -1) {
                    mediaEntities.splice(index, 1);
                }
                this.el.parentNode.removeChild(this.el);
                status.textContent = 'ğŸ—‘ï¸ Ø§Ù„Ø¹Ù†ØµØ± ØªÙ… Ø­Ø°ÙÙ‡';
            },
            
            tick: function() {
                // Keep instructions facing camera
                if (this.instructions && this.instructions.object3D) {
                    const camera = document.querySelector('[camera]');
                    if (camera) {
                        const cameraPos = camera.object3D.getWorldPosition(new THREE.Vector3());
                        this.instructions.object3D.lookAt(cameraPos);
                    }
                }
            }
        });

        // Function to enter AR
        function enterAR() {
            if (scene.hasLoaded) {
                scene.enterAR();
                status.textContent = 'ğŸš€ ØªÙ… Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ ÙˆØ¶Ø¹ AR - Ø§Ø±ÙØ¹ Ù‡Ø§ØªÙÙƒ Ù„Ù„Ø¨Ø¯Ø¡';
            } else {
                scene.addEventListener('loaded', () => {
                    scene.enterAR();
                    status.textContent = 'ğŸš€ ØªÙ… Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¥Ù„Ù‰ ÙˆØ¶Ø¹ AR - Ø§Ø±ÙØ¹ Ù‡Ø§ØªÙÙƒ Ù„Ù„Ø¨Ø¯Ø¡';
                });
            }
        }

        // Function to create and add thumbnail
        function addThumbnail(file) {
            const url = URL.createObjectURL(file);
            const isVideo = file.type.startsWith('video/');
            const fileName = file.name || 'media';
            
            loading.style.display = 'block';
            status.textContent = `â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ ${fileName}...`;

            const thumb = document.createElement(isVideo ? 'video' : 'img');
            thumb.src = url;
            thumb.className = 'thumb clickable';
            thumb.dataset.url = url;
            thumb.dataset.type = isVideo ? 'video' : 'image';
            thumb.dataset.name = fileName;
            
            if (isVideo) {
                thumb.muted = true;
                thumb.autoplay = true;
                thumb.loop = true;
                thumb.playsInline = true;
                thumb.preload = 'metadata';
                thumb.addEventListener('loadeddata', () => {
                    loading.style.display = 'none';
                    status.textContent = `âœ… ${fileName} Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¥Ø¶Ø§ÙØ©`;
                });
                thumb.addEventListener('error', (e) => {
                    loading.style.display = 'none';
                    status.textContent = `âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ: ${fileName}`;
                    console.error('Video load error:', e);
                });
            } else {
                thumb.onload = () => {
                    loading.style.display = 'none';
                    status.textContent = `âœ… ${fileName} Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¥Ø¶Ø§ÙØ©`;
                };
                thumb.onerror = () => {
                    loading.style.display = 'none';
                    status.textContent = `âŒ Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©: ${fileName}`;
                };
            }

            thumb.onclick = () => {
                if (thumb.dataset.url) {
                    addEntity(thumb.dataset.url, isVideo, fileName);
                }
            };

            // Add to main thumbnails
            thumbnailsDiv.appendChild(thumb);

            // Add to HUD thumbnails (smaller version)
            const hudThumb = thumb.cloneNode(true);
            hudThumb.className = 'hud-thumb';
            hudThumb.style.width = '60px';
            hudThumb.style.height = '80px';
            hudThumbnails.appendChild(hudThumb);
        }

        // Function to add media entity to scene
        function addEntity(url, isVideo, fileName) {
            loading.style.display = 'block';
            status.textContent = `ğŸ¨ Ø¬Ø§Ø±ÙŠ Ø¥Ø¶Ø§ÙØ© ${fileName} Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø´Ù‡Ø¯...`;

            // Create asset first
            const assetId = `media-${Date.now()}`;
            let assetElement;
            
            if (isVideo) {
                assetElement = document.createElement('video');
                assetElement.setAttribute('id', assetId);
                assetElement.setAttribute('src', url);
                assetElement.setAttribute('autoplay', 'true');
                assetElement.setAttribute('loop', 'true');
                assetElement.setAttribute('muted', 'true');
                assetElement.setAttribute('playsInline', 'true');
                assetElement.setAttribute('preload', 'auto');
                assetElement.setAttribute('webkit-playsinline', 'true');
                assetElement.crossOrigin = 'anonymous';
            } else {
                assetElement = document.createElement('img');
                assetElement.setAttribute('id', assetId);
                assetElement.setAttribute('src', url);
                assetElement.crossOrigin = 'anonymous';
            }
            
            assets.appendChild(assetElement);

            // Create entity
            const entity = document.createElement('a-entity');
            entity.classList.add('media-entity', 'interactive');
            mediaEntities.push(entity);

            // Calculate position in a circle
            const angle = placementCount * (360 / Math.max(mediaEntities.length, 1));
            const radius = 2.5 + (mediaEntities.length * 0.3);
            const x = Math.sin(angle * Math.PI / 180) * radius;
            const z = Math.cos(angle * Math.PI / 180) * radius;
            
            entity.setAttribute('position', `${x} 1.5 ${z}`);
            entity.setAttribute('rotation', `0 ${angle + 180} 0`);
            entity.setAttribute('scale', '1 1 1');
            entity.setAttribute('animation__enter', {
                property: 'scale',
                from: '0.1 0.1 0.1',
                to: '1 1 1',
                dur: 500,
                easing: 'easeOutElastic'
            });

            // Create media content
            let mediaContent;
            if (isVideo) {
                mediaContent = document.createElement('a-video');
                mediaContent.setAttribute('src', `#${assetId}`);
                mediaContent.setAttribute('width', '1.8');
                mediaContent.setAttribute('height', '1.2');
                mediaContent.setAttribute('autoplay', 'true');
                mediaContent.setAttribute('loop', 'true');
                mediaContent.setAttribute('muted', 'true');
                mediaContent.setAttribute('playsinline', 'true');
            } else {
                mediaContent = document.createElement('a-image');
                mediaContent.setAttribute('src', `#${assetId}`);
                mediaContent.setAttribute('width', '1.6');
                mediaContent.setAttribute('height', '1.6');
            }
            
            mediaContent.setAttribute('material', 'shader: flat; transparent: false; side: double');
            mediaContent.setAttribute('shadow', 'cast: true; receive: true');

            // Add frame
            const frame = document.createElement('a-entity');
            frame.setAttribute('geometry', 'primitive: box; width: 1.05; height: 1.05; depth: 0.1');
            frame.setAttribute('material', 'color: #7e22ce; metalness: 0.5; roughness: 0.5');
            frame.setAttribute('position', '0 0 -0.06');
            
            entity.appendChild(frame);
            entity.appendChild(mediaContent);
            
            // Add controls component
            entity.setAttribute('media-controls', '');
            entity.setAttribute('always-face-camera', '');
            
            // Add hover effect
            entity.setAttribute('event-set__mouseenter', 'scale: 1.05 1.05 1.05');
            entity.setAttribute('event-set__mouseleave', 'scale: 1 1 1');
            
            // Make it grabbable
            entity.setAttribute('grabbable', '');
            entity.setAttribute('draggable', '');

            // Add to scene
            scene.appendChild(entity);
            placementCount++;

            // Hide loading and show success
            setTimeout(() => {
                loading.style.display = 'none';
                status.textContent = `âœ… ${fileName} ØªÙ…Øª Ø¥Ø¶Ø§ÙØªÙ‡ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø´Ù‡Ø¯!`;
                
                // Play video if it's a video
                if (isVideo) {
                    const video = document.querySelector(`#${assetId}`);
                    if (video && video.play) {
                        video.play().catch(e => {
                            console.log('Video autoplay prevented, will play on interaction');
                            // Video will play on first user interaction
                        });
                    }
                }
            }, 800);
        }

        // File input handler
        document.getElementById('fileInput').addEventListener('change', (e) => {
            if (e.target.files.length === 0) return;
            
            status.textContent = `ğŸ“‚ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ ${e.target.files.length} Ù…Ù„Ù...`;
            
            for (const file of e.target.files) {
                if (file.size > 50 * 1024 * 1024) { // 50MB limit
                    alert(`Ø§Ù„Ù…Ù„Ù ${file.name} ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹ (Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰ 50MB)`);
                    continue;
                }
                addThumbnail(file);
            }
            
            e.target.value = ''; // Reset input
        });

        // Clear all function
        function clearAll() {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§ØªØŸ')) return;
            
            // Clear thumbnails
            thumbnailsDiv.innerHTML = '';
            hudThumbnails.innerHTML = '';
            
            // Clear media entities
            const mediaEntities = document.querySelectorAll('.media-entity');
            mediaEntities.forEach(entity => {
                if (entity.parentNode) {
                    entity.parentNode.removeChild(entity);
                }
            });
            
            // Clear assets
            assets.innerHTML = '';
            
            placementCount = 0;
            mediaEntities.length = 0;
            selectedEntity = null;
            
            status.textContent = 'ğŸ—‘ï¸ ØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­ØªÙˆÙŠØ§Øª';
        }

        // Reset positions function
        function resetPositions() {
            const entities = document.querySelectorAll('.media-entity');
            entities.forEach((entity, index) => {
                const angle = index * (360 / entities.length);
                const radius = 2.5 + (entities.length * 0.3);
                const x = Math.sin(angle * Math.PI / 180) * radius;
                const z = Math.cos(angle * Math.PI / 180) * radius;
                
                entity.setAttribute('animation', {
                    property: 'position',
                    to: `${x} 1.5 ${z}`,
                    dur: 1000,
                    easing: 'easeInOutQuad'
                });
                
                entity.setAttribute('animation__rotate', {
                    property: 'rotation',
                    to: `0 ${angle + 180} 0`,
                    dur: 1000,
                    easing: 'easeInOutQuad'
                });
            });
            
            status.textContent = 'ğŸ”„ ØªÙ…Øª Ø¥Ø¹Ø§Ø¯Ø© ØªØ±ØªÙŠØ¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù†Ø§ØµØ±';
        }

        // Initialize scene
        scene.addEventListener('loaded', () => {
            status.textContent = 'âœ… Ø§Ù„Ù…Ø´Ù‡Ø¯ Ø¬Ø§Ù‡Ø²! Ø§Ø±ÙØ¹ Ù…Ù„ÙØ§ØªÙƒ Ù„Ù„Ø¨Ø¯Ø¡';
            console.log('Scene loaded successfully');
        });

        // Handle video play on first interaction
        document.addEventListener('click', () => {
            const videos = document.querySelectorAll('video');
            videos.forEach(video => {
                if (video.paused && video.readyState >= 2) {
                    video.play().catch(e => console.log('Video play prevented'));
                }
            });
        });

        // Handle AR mode
        scene.addEventListener('enter-vr', () => {
            status.textContent = 'ğŸ® Ø£Ù†Øª Ø§Ù„Ø¢Ù† ÙÙŠ ÙˆØ¶Ø¹ VR/AR - Ø§Ø³ØªØ®Ø¯Ù… ÙŠØ¯ÙŠÙƒ Ù„Ù„ØªØ­ÙƒÙ…';
        });

        scene.addEventListener('exit-vr', () => {
            status.textContent = 'ğŸ  Ø®Ø±Ø¬Øª Ù…Ù† ÙˆØ¶Ø¹ VR/AR';
        });

        // Initialize
        window.onload = () => {
            status.textContent = 'ğŸ‘† Ø§Ø±ÙØ¹ ØµÙˆØ±Ø§Ù‹ Ø£Ùˆ ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª Ù„Ù„Ø¨Ø¯Ø¡';
        };
    </script>
</body>
</html>
